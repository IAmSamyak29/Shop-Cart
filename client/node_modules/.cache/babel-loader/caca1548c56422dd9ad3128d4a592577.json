{"ast":null,"code":"var _jsxFileName = \"/home/samyak/Desktop/Web Dev/Coding/Projects/Ecommerce/client/src/components/mainpages/createProduct/CreateProduct.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext } from 'react';\nimport axios from 'axios';\nimport { GlobalState } from '../../../GlobalState';\nimport Loading from '../utils/loading/Loading';\nimport { useHistory } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  product_id: '',\n  title: '',\n  price: 0,\n  description: 'This is my description did u like it',\n  content: 'Welcome to my content in the laptop',\n  category: ''\n};\n\nfunction CreateProduct() {\n  _s();\n\n  const state = useContext(GlobalState);\n  const [product, setProduct] = useState(initialState);\n  const [categories] = state.categoriesAPI.categories;\n  const [images, setImages] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [isAdmin] = state.userAPI.isAdmin;\n  const [token] = state.token;\n  const history = useHistory();\n\n  const handleUpload = async e => {\n    e.preventDefault();\n\n    try {\n      if (!isAdmin) return alert(\"You are not an admin\");\n      const file = e.target.files[0];\n      if (!file) return alert(\"File not exist.\");\n      if (file.size > 1024 * 1024) //1mb\n        return alert(\"Size too large!\");\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png') return alert(\"File format is incorrect\");\n      let formData = new FormData();\n      formData.append('file', file);\n      setLoading(true);\n      const res = await axios.post('api/upload', formData, {\n        headers: {\n          'content-type': 'multipart/form-data',\n          Authorization: token\n        }\n      });\n      setLoading(false);\n      setImages(res.data);\n    } catch (error) {\n      alert(error.response.data.msg);\n    }\n  };\n\n  const handleDestory = async () => {\n    try {\n      if (!isAdmin) return alert(\"You are not an admin\");\n      setLoading(true);\n      await axios.post('/api/destroy', {\n        public_id: images.public_id\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      setLoading(false);\n      setImages(false);\n    } catch (error) {\n      alert(error.response.data.msg);\n    }\n  };\n\n  const handleChangeInput = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setProduct({ ...product,\n      [name]: value\n    });\n  };\n\n  const styleUpload = {\n    display: images ? \"block\" : \"none\"\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    try {\n      if (!isAdmin) return alert(\"You're not an admin\");\n      if (!images) return alert(\"No Image Upload\");\n      await axios.post('/api/products', { ...product,\n        images\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      setImages(false);\n      history.push(\"/\");\n    } catch (err) {\n      alert(err.response.data.msg);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"create_product\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"upload\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        name: \"file\",\n        id: \"file_up\",\n        onChange: handleUpload\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"file_img\",\n        children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"file_img\",\n        style: styleUpload,\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: images ? images.url : \"\",\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: handleDestory,\n          children: \"X\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"product_id\",\n          children: \"Product ID\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"product_id\",\n          id: \"product_id\",\n          required: true,\n          value: product.product_id,\n          onChange: handleChangeInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"title\",\n          children: \"Title\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"title\",\n          id: \"title\",\n          required: true,\n          value: product.title,\n          onChange: handleChangeInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"price\",\n          children: \"Price\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"price\",\n          id: \"price\",\n          required: true,\n          value: product.price,\n          onChange: handleChangeInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"description\",\n          children: \"Description\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          type: \"text\",\n          name: \"description\",\n          id: \"description\",\n          required: true,\n          value: product.description,\n          onChange: handleChangeInput,\n          rows: \"5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"content\",\n          children: \"Content\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          type: \"text\",\n          name: \"content\",\n          id: \"content\",\n          required: true,\n          value: product.content,\n          onChange: handleChangeInput,\n          row: \"7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"categories\",\n          children: \"Categories: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"category\",\n          value: product.category,\n          onChange: handleChangeInput,\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"Please Select a category\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 13\n          }, this), categories.map(category => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: category._id,\n            children: category.name\n          }, category._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Create\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CreateProduct, \"IIgkfhGGVKGFuXUXeSpxjUqyhs4=\", false, function () {\n  return [useHistory];\n});\n\n_c = CreateProduct;\nexport default CreateProduct;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateProduct\");","map":{"version":3,"sources":["/home/samyak/Desktop/Web Dev/Coding/Projects/Ecommerce/client/src/components/mainpages/createProduct/CreateProduct.js"],"names":["React","useState","useContext","axios","GlobalState","Loading","useHistory","initialState","product_id","title","price","description","content","category","CreateProduct","state","product","setProduct","categories","categoriesAPI","images","setImages","loading","setLoading","isAdmin","userAPI","token","history","handleUpload","e","preventDefault","alert","file","target","files","size","type","formData","FormData","append","res","post","headers","Authorization","data","error","response","msg","handleDestory","public_id","handleChangeInput","name","value","styleUpload","display","handleSubmit","push","err","url","map","_id"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,UAA1B,QAA4C,OAA5C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,WAAT,QAA4B,sBAA5B;AACA,OAAOC,OAAP,MAAoB,0BAApB;AACA,SAASC,UAAT,QAA2B,kBAA3B;;AAEA,MAAMC,YAAY,GAAG;AACjBC,EAAAA,UAAU,EAAE,EADK;AAEjBC,EAAAA,KAAK,EAAE,EAFU;AAGjBC,EAAAA,KAAK,EAAE,CAHU;AAIjBC,EAAAA,WAAW,EAAE,sCAJI;AAKjBC,EAAAA,OAAO,EAAE,qCALQ;AAMjBC,EAAAA,QAAQ,EAAC;AANQ,CAArB;;AASA,SAASC,aAAT,GAAyB;AAAA;;AACrB,QAAMC,KAAK,GAAGb,UAAU,CAACE,WAAD,CAAxB;AACA,QAAM,CAACY,OAAD,EAAUC,UAAV,IAAwBhB,QAAQ,CAACM,YAAD,CAAtC;AACA,QAAM,CAACW,UAAD,IAAeH,KAAK,CAACI,aAAN,CAAoBD,UAAzC;AACA,QAAM,CAACE,MAAD,EAASC,SAAT,IAAsBpB,QAAQ,CAAC,KAAD,CAApC;AACF,QAAM,CAACqB,OAAD,EAAUC,UAAV,IAAwBtB,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAACuB,OAAD,IAAYT,KAAK,CAACU,OAAN,CAAcD,OAAhC;AACA,QAAM,CAACE,KAAD,IAAUX,KAAK,CAACW,KAAtB;AAEA,QAAMC,OAAO,GAAGrB,UAAU,EAA1B;;AAGA,QAAMsB,YAAY,GAAG,MAAMC,CAAN,IAAW;AAC9BA,IAAAA,CAAC,CAACC,cAAF;;AACA,QAAI;AACF,UAAI,CAACN,OAAL,EAAc,OAAOO,KAAK,CAAC,sBAAD,CAAZ;AACd,YAAMC,IAAI,GAAGH,CAAC,CAACI,MAAF,CAASC,KAAT,CAAe,CAAf,CAAb;AAGA,UAAI,CAACF,IAAL,EAAW,OAAOD,KAAK,CAAC,iBAAD,CAAZ;AAEX,UAAIC,IAAI,CAACG,IAAL,GAAY,OAAO,IAAvB,EAA6B;AAC3B,eAAOJ,KAAK,CAAC,iBAAD,CAAZ;AAEF,UAAIC,IAAI,CAACI,IAAL,KAAc,YAAd,IAA8BJ,IAAI,CAACI,IAAL,KAAc,WAAhD,EACE,OAAOL,KAAK,CAAC,0BAAD,CAAZ;AAGF,UAAIM,QAAQ,GAAG,IAAIC,QAAJ,EAAf;AACAD,MAAAA,QAAQ,CAACE,MAAT,CAAgB,MAAhB,EAAwBP,IAAxB;AAGAT,MAAAA,UAAU,CAAC,IAAD,CAAV;AACA,YAAMiB,GAAG,GAAG,MAAMrC,KAAK,CAACsC,IAAN,CAAW,YAAX,EAAyBJ,QAAzB,EAAmC;AACnDK,QAAAA,OAAO,EAAC;AAAC,0BAAe,qBAAhB;AAAsCC,UAAAA,aAAa,EAACjB;AAApD;AAD2C,OAAnC,CAAlB;AAIAH,MAAAA,UAAU,CAAC,KAAD,CAAV;AACAF,MAAAA,SAAS,CAACmB,GAAG,CAACI,IAAL,CAAT;AAED,KA1BD,CA0BE,OAAOC,KAAP,EAAc;AACdd,MAAAA,KAAK,CAACc,KAAK,CAACC,QAAN,CAAeF,IAAf,CAAoBG,GAArB,CAAL;AACD;AACF,GA/BD;;AAiCA,QAAMC,aAAa,GAAG,YAAY;AAChC,QAAI;AACF,UAAI,CAACxB,OAAL,EAAc,OAAOO,KAAK,CAAC,sBAAD,CAAZ;AACdR,MAAAA,UAAU,CAAC,IAAD,CAAV;AACA,YAAMpB,KAAK,CAACsC,IAAN,CAAW,cAAX,EAA2B;AAAEQ,QAAAA,SAAS,EAAE7B,MAAM,CAAC6B;AAApB,OAA3B,EAA4D;AAChEP,QAAAA,OAAO,EAAC;AAACC,UAAAA,aAAa,EAACjB;AAAf;AADwD,OAA5D,CAAN;AAGAH,MAAAA,UAAU,CAAC,KAAD,CAAV;AACAF,MAAAA,SAAS,CAAC,KAAD,CAAT;AACD,KARD,CAQE,OAAOwB,KAAP,EAAc;AACdd,MAAAA,KAAK,CAACc,KAAK,CAACC,QAAN,CAAeF,IAAf,CAAoBG,GAArB,CAAL;AACH;AACA,GAZD;;AAcA,QAAMG,iBAAiB,GAAGrB,CAAC,IAAI;AAC7B,UAAM;AAAEsB,MAAAA,IAAF;AAAQC,MAAAA;AAAR,QAAkBvB,CAAC,CAACI,MAA1B;AAEAhB,IAAAA,UAAU,CAAC,EAAC,GAAGD,OAAJ;AAAY,OAACmC,IAAD,GAAOC;AAAnB,KAAD,CAAV;AACD,GAJD;;AAMA,QAAMC,WAAW,GAAG;AAClBC,IAAAA,OAAO,EAAElC,MAAM,GAAG,OAAH,GAAa;AADV,GAApB;;AAIA,QAAMmC,YAAY,GAAE,MAAM1B,CAAN,IAAW;AAC7BA,IAAAA,CAAC,CAACC,cAAF;;AACA,QAAI;AACF,UAAI,CAACN,OAAL,EAAc,OAAOO,KAAK,CAAC,qBAAD,CAAZ;AACd,UAAI,CAACX,MAAL,EAAa,OAAOW,KAAK,CAAC,iBAAD,CAAZ;AAEb,YAAM5B,KAAK,CAACsC,IAAN,CAAW,eAAX,EAA4B,EAAE,GAAGzB,OAAL;AAAcI,QAAAA;AAAd,OAA5B,EAAoD;AACxDsB,QAAAA,OAAO,EAAC;AAACC,UAAAA,aAAa,EAACjB;AAAf;AADgD,OAApD,CAAN;AAIAL,MAAAA,SAAS,CAAC,KAAD,CAAT;AAGAM,MAAAA,OAAO,CAAC6B,IAAR,CAAa,GAAb;AACD,KAZD,CAYE,OAAOC,GAAP,EAAY;AACZ1B,MAAAA,KAAK,CAAC0B,GAAG,CAACX,QAAJ,CAAaF,IAAb,CAAkBG,GAAnB,CAAL;AACD;AACF,GAjBD;;AAsBA,sBACE;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA,4BACE;AAAK,MAAA,SAAS,EAAC,QAAf;AAAA,8BACE;AACE,QAAA,IAAI,EAAC,MADP;AAEE,QAAA,IAAI,EAAC,MAFP;AAGE,QAAA,EAAE,EAAC,SAHL;AAIE,QAAA,QAAQ,EAAEnB;AAJZ;AAAA;AAAA;AAAA;AAAA,cADF,EAOGN,OAAO,gBACN;AAAK,QAAA,EAAE,EAAC,UAAR;AAAA,+BACE,QAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cADM,gBAKN;AAAK,QAAA,EAAE,EAAC,UAAR;AAAmB,QAAA,KAAK,EAAE+B,WAA1B;AAAA,gCACE;AAAK,UAAA,GAAG,EAAEjC,MAAM,GAAGA,MAAM,CAACsC,GAAV,GAAgB,EAAhC;AAAoC,UAAA,GAAG,EAAC;AAAxC;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAM,UAAA,OAAO,EAAEV,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cAZJ;AAAA;AAAA;AAAA;AAAA;AAAA,YADF,eAoBE;AAAM,MAAA,QAAQ,EAAEO,YAAhB;AAAA,8BACE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA,gCACE;AAAO,UAAA,OAAO,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,IAAI,EAAC,YAFP;AAGE,UAAA,EAAE,EAAC,YAHL;AAIE,UAAA,QAAQ,MAJV;AAKE,UAAA,KAAK,EAAEvC,OAAO,CAACR,UALjB;AAME,UAAA,QAAQ,EAAE0C;AANZ;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAaE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA,gCACE;AAAO,UAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,IAAI,EAAC,OAFP;AAGE,UAAA,EAAE,EAAC,OAHL;AAIE,UAAA,QAAQ,MAJV;AAKE,UAAA,KAAK,EAAElC,OAAO,CAACP,KALjB;AAME,UAAA,QAAQ,EAAEyC;AANZ;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cAbF,eAyBE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA,gCACE;AAAO,UAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,IAAI,EAAC,OAFP;AAGE,UAAA,EAAE,EAAC,OAHL;AAIE,UAAA,QAAQ,MAJV;AAKE,UAAA,KAAK,EAAElC,OAAO,CAACN,KALjB;AAME,UAAA,QAAQ,EAAEwC;AANZ;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cAzBF,eAqCE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA,gCACE;AAAO,UAAA,OAAO,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,IAAI,EAAC,aAFP;AAGE,UAAA,EAAE,EAAC,aAHL;AAIE,UAAA,QAAQ,MAJV;AAKE,UAAA,KAAK,EAAElC,OAAO,CAACL,WALjB;AAME,UAAA,QAAQ,EAAEuC,iBANZ;AAOE,UAAA,IAAI,EAAC;AAPP;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cArCF,eAkDE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA,gCACE;AAAO,UAAA,OAAO,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,IAAI,EAAC,SAFP;AAGE,UAAA,EAAE,EAAC,SAHL;AAIE,UAAA,QAAQ,MAJV;AAKE,UAAA,KAAK,EAAElC,OAAO,CAACJ,OALjB;AAME,UAAA,QAAQ,EAAEsC,iBANZ;AAOE,UAAA,GAAG,EAAC;AAPN;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cAlDF,eA+DE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA,gCACE;AAAO,UAAA,OAAO,EAAC,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AACE,UAAA,IAAI,EAAC,UADP;AAEE,UAAA,KAAK,EAAElC,OAAO,CAACH,QAFjB;AAGE,UAAA,QAAQ,EAAEqC,iBAHZ;AAAA,kCAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBALF,EAMGhC,UAAU,CAACyC,GAAX,CAAgB9C,QAAD,iBACd;AAAQ,YAAA,KAAK,EAAEA,QAAQ,CAAC+C,GAAxB;AAAA,sBACG/C,QAAQ,CAACsC;AADZ,aAAkCtC,QAAQ,CAAC+C,GAA3C;AAAA;AAAA;AAAA;AAAA,kBADD,CANH;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cA/DF,eA+EE;AAAQ,QAAA,IAAI,EAAC,QAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cA/EF;AAAA;AAAA;AAAA;AAAA;AAAA,YApBF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAwGD;;GAnMQ9C,a;UASSR,U;;;KATTQ,a;AAqMT,eAAeA,aAAf","sourcesContent":["import React, { useState, useContext } from 'react'\nimport axios from 'axios';\nimport { GlobalState } from '../../../GlobalState';\nimport Loading from '../utils/loading/Loading';\nimport { useHistory } from 'react-router-dom'\n\nconst initialState = {\n    product_id: '',\n    title: '',\n    price: 0,\n    description: 'This is my description did u like it',\n    content: 'Welcome to my content in the laptop',\n    category:''\n}\n\nfunction CreateProduct() {\n    const state = useContext(GlobalState);\n    const [product, setProduct] = useState(initialState);\n    const [categories] = state.categoriesAPI.categories;\n    const [images, setImages] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [isAdmin] = state.userAPI.isAdmin;\n  const [token] = state.token;\n\n  const history = useHistory();\n  \n\n  const handleUpload = async e => {\n    e.preventDefault();\n    try {\n      if (!isAdmin) return alert(\"You are not an admin\");\n      const file = e.target.files[0];\n\n\n      if (!file) return alert(\"File not exist.\");\n\n      if (file.size > 1024 * 1024) //1mb\n        return alert(\"Size too large!\");\n\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png')\n        return alert(\"File format is incorrect\");\n      \n      \n      let formData = new FormData();\n      formData.append('file', file);\n\n\n      setLoading(true);\n      const res = await axios.post('api/upload', formData, {\n        headers:{'content-type':'multipart/form-data',Authorization:token}\n      });\n\n      setLoading(false);\n      setImages(res.data);\n        \n    } catch (error) {\n      alert(error.response.data.msg);\n    }\n  }\n\n  const handleDestory = async () => {\n    try {\n      if (!isAdmin) return alert(\"You are not an admin\");\n      setLoading(true);\n      await axios.post('/api/destroy', { public_id: images.public_id }, {\n        headers:{Authorization:token}\n      })\n      setLoading(false);\n      setImages(false);\n    } catch (error) {\n      alert(error.response.data.msg);\n  }\n  }\n\n  const handleChangeInput = e => {\n    const { name, value } = e.target;\n\n    setProduct({...product,[name]:value})\n  }\n  \n  const styleUpload = {\n    display: images ? \"block\" : \"none\",\n  };\n\n  const handleSubmit =async e => {\n    e.preventDefault();\n    try {\n      if (!isAdmin) return alert(\"You're not an admin\");\n      if (!images) return alert(\"No Image Upload\");\n\n      await axios.post('/api/products', { ...product, images }, {\n        headers:{Authorization:token}\n      })\n\n      setImages(false);\n      \n\n      history.push(\"/\");\n    } catch (err) {\n      alert(err.response.data.msg);\n    }\n  }\n\n\n    \n\n  return (\n    <div className=\"create_product\">\n      <div className=\"upload\">\n        <input\n          type=\"file\"\n          name=\"file\"\n          id=\"file_up\"\n          onChange={handleUpload}\n        ></input>\n        {loading ? \n          <div id=\"file_img\">\n            <Loading />\n          </div>\n         : \n          <div id=\"file_img\" style={styleUpload}>\n            <img src={images ? images.url : \"\"} alt=\"\" />\n            <span onClick={handleDestory}>X</span>\n          </div>\n        }\n      </div>\n\n      <form onSubmit={handleSubmit}>\n        <div className=\"row\">\n          <label htmlFor=\"product_id\">Product ID</label>\n          <input\n            type=\"text\"\n            name=\"product_id\"\n            id=\"product_id\"\n            required\n            value={product.product_id}\n            onChange={handleChangeInput}\n          ></input>\n        </div>\n\n        <div className=\"row\">\n          <label htmlFor=\"title\">Title</label>\n          <input\n            type=\"text\"\n            name=\"title\"\n            id=\"title\"\n            required\n            value={product.title}\n            onChange={handleChangeInput}\n          ></input>\n        </div>\n\n        <div className=\"row\">\n          <label htmlFor=\"price\">Price</label>\n          <input\n            type=\"text\"\n            name=\"price\"\n            id=\"price\"\n            required\n            value={product.price}\n            onChange={handleChangeInput}\n          ></input>\n        </div>\n\n        <div className=\"row\">\n          <label htmlFor=\"description\">Description</label>\n          <textarea\n            type=\"text\"\n            name=\"description\"\n            id=\"description\"\n            required\n            value={product.description}\n            onChange={handleChangeInput}\n            rows=\"5\"\n          />\n        </div>\n\n        <div className=\"row\">\n          <label htmlFor=\"content\">Content</label>\n          <textarea\n            type=\"text\"\n            name=\"content\"\n            id=\"content\"\n            required\n            value={product.content}\n            onChange={handleChangeInput}\n            row=\"7\"\n          />\n        </div>\n\n        <div className=\"row\">\n          <label htmlFor=\"categories\">Categories: </label>\n          <select\n            name=\"category\"\n            value={product.category}\n            onChange={handleChangeInput}\n          >\n            <option>Please Select a category</option>\n            {categories.map((category) => (\n              <option value={category._id} key={category._id}>\n                {category.name}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <button type=\"submit\">Create</button>\n      </form>\n    </div>\n  );\n}\n\nexport default CreateProduct"]},"metadata":{},"sourceType":"module"}