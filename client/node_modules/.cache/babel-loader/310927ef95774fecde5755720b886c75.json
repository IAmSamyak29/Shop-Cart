{"ast":null,"code":"var _jsxFileName = \"/home/samyak/Desktop/Web Dev/Coding/Projects/Ecommerce/client/src/components/mainpages/createProduct/CreateProduct.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useEffect } from 'react';\nimport axios from 'axios';\nimport { GlobalState } from '../../../GlobalState';\nimport Loading from '../utils/loading/Loading';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  product_id: '',\n  title: '',\n  price: 0,\n  description: 'This is my description did u like it',\n  content: 'Welcome to my content in the laptop',\n  category: '',\n  id: ''\n};\n\nfunction CreateProduct() {\n  _s();\n\n  const state = useContext(GlobalState);\n  const [product, setProduct] = useState(initialState);\n  const [categories] = state.categoriesAPI.categories;\n  const [images, setImages] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [isAdmin] = state.userAPI.isAdmin;\n  const [token] = state.token;\n  const navigate = useNavigate();\n  const param = useParams();\n  const [products] = state.productsAPI.products;\n  useEffect(() => {\n    if (param.id) {\n      products.forEach(product => {\n        if (product._id === param.id) {\n          setProduct(product);\n          setImages(product.images);\n        }\n      });\n    }\n  }, [param.id]);\n\n  const handleUpload = async e => {\n    e.preventDefault();\n\n    try {\n      if (!isAdmin) return alert(\"You are not an admin\");\n      const file = e.target.files[0];\n      if (!file) return alert(\"File not exist.\");\n      if (file.size > 1024 * 1024) //1mb\n        return alert(\"Size too large!\");\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png') return alert(\"File format is incorrect\");\n      let formData = new FormData();\n      formData.append('file', file);\n      setLoading(true);\n      const res = await axios.post('api/upload', formData, {\n        headers: {\n          'content-type': 'multipart/form-data',\n          Authorization: token\n        }\n      });\n      setLoading(false);\n      setImages(res.data);\n    } catch (error) {\n      alert(error.response.data.msg);\n    }\n  };\n\n  const handleDestory = async () => {\n    try {\n      if (!isAdmin) return alert(\"You are not an admin\");\n      setLoading(true);\n      await axios.post('/api/destroy', {\n        public_id: images.public_id\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      setLoading(false);\n      setImages(false);\n    } catch (error) {\n      alert(error.response.data.msg);\n    }\n  };\n\n  const handleChangeInput = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setProduct({ ...product,\n      [name]: value\n    });\n  };\n\n  const styleUpload = {\n    display: images ? \"block\" : \"none\"\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    try {\n      if (!isAdmin) return alert(\"You're not an admin\");\n      if (!images) return alert(\"No Image Upload\");\n      await axios.post('/api/products', { ...product,\n        images\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      setImages(false);\n      setProduct(initialState);\n      navigate.push(\"/\");\n    } catch (err) {\n      alert(err.response.data.msg);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"create_product\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"upload\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        name: \"file\",\n        id: \"file_up\",\n        onChange: handleUpload\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"file_img\",\n        children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"file_img\",\n        style: styleUpload,\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: images ? images.url : \"\",\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          onClick: handleDestory,\n          children: \"X\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"product_id\",\n          children: \"Product ID\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"product_id\",\n          id: \"product_id\",\n          required: true,\n          value: product.product_id,\n          onChange: handleChangeInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"title\",\n          children: \"Title\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"title\",\n          id: \"title\",\n          required: true,\n          value: product.title,\n          onChange: handleChangeInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"price\",\n          children: \"Price\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"price\",\n          id: \"price\",\n          required: true,\n          value: product.price,\n          onChange: handleChangeInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"description\",\n          children: \"Description\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          type: \"text\",\n          name: \"description\",\n          id: \"description\",\n          required: true,\n          value: product.description,\n          onChange: handleChangeInput,\n          rows: \"5\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"content\",\n          children: \"Content\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          type: \"text\",\n          name: \"content\",\n          id: \"content\",\n          required: true,\n          value: product.content,\n          onChange: handleChangeInput,\n          row: \"7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"categories\",\n          children: \"Categories: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n          name: \"category\",\n          value: product.category,\n          onChange: handleChangeInput,\n          children: [/*#__PURE__*/_jsxDEV(\"option\", {\n            children: \"Please Select a category\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 13\n          }, this), categories.map(category => /*#__PURE__*/_jsxDEV(\"option\", {\n            value: category._id,\n            children: category.name\n          }, category._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 15\n          }, this))]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Create\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 124,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CreateProduct, \"dzZyeap3nMDqX88DJvDfnJua99U=\", false, function () {\n  return [useNavigate, useParams];\n});\n\n_c = CreateProduct;\nexport default CreateProduct;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateProduct\");","map":{"version":3,"sources":["/home/samyak/Desktop/Web Dev/Coding/Projects/Ecommerce/client/src/components/mainpages/createProduct/CreateProduct.js"],"names":["React","useState","useContext","useEffect","axios","GlobalState","Loading","useNavigate","useParams","initialState","product_id","title","price","description","content","category","id","CreateProduct","state","product","setProduct","categories","categoriesAPI","images","setImages","loading","setLoading","isAdmin","userAPI","token","navigate","param","products","productsAPI","forEach","_id","handleUpload","e","preventDefault","alert","file","target","files","size","type","formData","FormData","append","res","post","headers","Authorization","data","error","response","msg","handleDestory","public_id","handleChangeInput","name","value","styleUpload","display","handleSubmit","push","err","url","map"],"mappings":"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","sourcesContent":["import React, { useState, useContext,useEffect } from 'react'\nimport axios from 'axios';\nimport { GlobalState } from '../../../GlobalState';\nimport Loading from '../utils/loading/Loading';\nimport { useNavigate,useParams } from 'react-router-dom'\n\nconst initialState = {\n    product_id: '',\n    title: '',\n    price: 0,\n    description: 'This is my description did u like it',\n    content: 'Welcome to my content in the laptop',\n  category: '',\n    id:''\n}\n\nfunction CreateProduct() {\n    const state = useContext(GlobalState);\n    const [product, setProduct] = useState(initialState);\n    const [categories] = state.categoriesAPI.categories;\n    const [images, setImages] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [isAdmin] = state.userAPI.isAdmin;\n  const [token] = state.token;\n\n  const navigate = useNavigate();\n  const param = useParams();\n\n  const [products] = state.productsAPI.products;\n\n  useEffect(() => {\n    if (param.id) {\n      products.forEach(product => {\n        if (product._id === param.id)\n        {\n          \n          setProduct(product);\n          setImages(product.images);\n          }\n      })\n    }\n  }, [param.id]);\n  \n\n  const handleUpload = async e => {\n    e.preventDefault();\n    try {\n      if (!isAdmin) return alert(\"You are not an admin\");\n      const file = e.target.files[0];\n\n\n      if (!file) return alert(\"File not exist.\");\n\n      if (file.size > 1024 * 1024) //1mb\n        return alert(\"Size too large!\");\n\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png')\n        return alert(\"File format is incorrect\");\n      \n      \n      let formData = new FormData();\n      formData.append('file', file);\n\n\n      setLoading(true);\n      const res = await axios.post('api/upload', formData, {\n        headers:{'content-type':'multipart/form-data',Authorization:token}\n      });\n\n      setLoading(false);\n      setImages(res.data);\n        \n    } catch (error) {\n      alert(error.response.data.msg);\n    }\n  }\n\n  const handleDestory = async () => {\n    try {\n      if (!isAdmin) return alert(\"You are not an admin\");\n      setLoading(true);\n      await axios.post('/api/destroy', { public_id: images.public_id }, {\n        headers:{Authorization:token}\n      })\n      setLoading(false);\n      setImages(false);\n    } catch (error) {\n      alert(error.response.data.msg);\n  }\n  }\n\n  const handleChangeInput = e => {\n    const { name, value } = e.target;\n\n    setProduct({...product,[name]:value})\n  }\n  \n  const styleUpload = {\n    display: images ? \"block\" : \"none\",\n  };\n\n  const handleSubmit =async e => {\n    e.preventDefault();\n    try {\n      if (!isAdmin) return alert(\"You're not an admin\");\n      if (!images) return alert(\"No Image Upload\");\n\n      await axios.post('/api/products', { ...product, images }, {\n        headers:{Authorization:token}\n      })\n\n      setImages(false);\n      setProduct(initialState);\n      navigate.push(\"/\");\n    } catch (err) {\n      alert(err.response.data.msg);\n    }\n  }\n\n\n    \n\n  return (\n    <div className=\"create_product\">\n      <div className=\"upload\">\n        <input\n          type=\"file\"\n          name=\"file\"\n          id=\"file_up\"\n          onChange={handleUpload}\n        ></input>\n        {loading ? \n          <div id=\"file_img\">\n            <Loading />\n          </div>\n         : \n          <div id=\"file_img\" style={styleUpload}>\n            <img src={images ? images.url : \"\"} alt=\"\" />\n            <span onClick={handleDestory}>X</span>\n          </div>\n        }\n      </div>\n\n      <form onSubmit={handleSubmit}>\n        <div className=\"row\">\n          <label htmlFor=\"product_id\">Product ID</label>\n          <input\n            type=\"text\"\n            name=\"product_id\"\n            id=\"product_id\"\n            required\n            value={product.product_id}\n            onChange={handleChangeInput}\n          ></input>\n        </div>\n\n        <div className=\"row\">\n          <label htmlFor=\"title\">Title</label>\n          <input\n            type=\"text\"\n            name=\"title\"\n            id=\"title\"\n            required\n            value={product.title}\n            onChange={handleChangeInput}\n          ></input>\n        </div>\n\n        <div className=\"row\">\n          <label htmlFor=\"price\">Price</label>\n          <input\n            type=\"text\"\n            name=\"price\"\n            id=\"price\"\n            required\n            value={product.price}\n            onChange={handleChangeInput}\n          ></input>\n        </div>\n\n        <div className=\"row\">\n          <label htmlFor=\"description\">Description</label>\n          <textarea\n            type=\"text\"\n            name=\"description\"\n            id=\"description\"\n            required\n            value={product.description}\n            onChange={handleChangeInput}\n            rows=\"5\"\n          />\n        </div>\n\n        <div className=\"row\">\n          <label htmlFor=\"content\">Content</label>\n          <textarea\n            type=\"text\"\n            name=\"content\"\n            id=\"content\"\n            required\n            value={product.content}\n            onChange={handleChangeInput}\n            row=\"7\"\n          />\n        </div>\n\n        <div className=\"row\">\n          <label htmlFor=\"categories\">Categories: </label>\n          <select\n            name=\"category\"\n            value={product.category}\n            onChange={handleChangeInput}\n          >\n            <option>Please Select a category</option>\n            {categories.map((category) => (\n              <option value={category._id} key={category._id}>\n                {category.name}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        <button type=\"submit\">Create</button>\n      </form>\n    </div>\n  );\n}\n\nexport default CreateProduct"]},"metadata":{},"sourceType":"module"}